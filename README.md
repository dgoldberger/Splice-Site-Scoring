Splice-Site-Scoring
===================

Takes VCF file as input and scores the corresponding DNA sequences based on the likelihood that the given variant will disrupt the RNA splicing process. 

Step by step summary: 

	The splice variant effect predictor takes a VCF file as input and writes a new VCF file with an annotated info section. The program uses the genomic coordinates to access the surrounding sequences through the Ensembl API. The program first determines if the variant is in a splice region. It looks for protein coding genes at that coordinate and selects the first protein-coding transcript that contains the variant. That transcript is used to get the sequence. An exon’s start and end positions are relative to the variants location. For example, if an exon’s start is -4 and the end is 100, then the variant is just downstream of the exon start and is in the exon. Using this information the program can determine whether a variant is in an intron or exon and whether it is near the five prime or three prime splice site. If a variant is in an intron and is more than 20 nucleotides away from an exon, then the program just writes that entry to the VCF file unchanged. If a variant is near a splice site, then it goes on to measure the score for disruption.
	The program determines what strand the variant is on and accordingly assesses its exon coordinates to extract the correct portion of the exon and adjacent intron. For three prime, it looks at the end of the preceding intron and for five prime it looks at the beginning of the succeeding intron. It then calculates the “information score” of the reference and alternative splice sites. A five prime splice site is -2 to 6 and a three prime splice site is -3 to 2. The five prime scorer uses dinucleotide frequencies and the three prime uses single nucleotide frequencies. Refer to figure 1 for more information on the information scoring method. The ratio of alternative information score to reference information score is then interpreted for a final score. This calculation is done using the distribution of ratios for sets of common splice site variants, assumed to have no affect on splicing. The final score is simply 1-(proportion of common ratios less than x), where x is the ratio for the splice site variant we are scoring. So the higher the ratio is, the lower the score is. If the final score is below an arbitrary threshold (currently set to .6 for donor and .4 for acceptor), then the program writes that entry unchanged. Otherwise it appends the info field with “DONOR_DISRUPT” and “ACCEPTOR_DISRUPT”. The threshold as they are set now, annotates 78% of all known splice-disrupting variants. The frequency hashes, SNP ratio set, disruptive ratio set, scoring sub routines, and flag variables (used to mark is a site is exonic, in a splice site, etc.) are all defined at the beginning of the program before it even begins looking at the VCF file entries (while(<>)). 
	If a variant is in an exon but not in a splice site or is between 8 and 20 nucleotides away from an exon and is in an intron, then the program evaluates the likelihood of this variant creating a cryptic splice site. The logic behind this scoring is very similar to the splice disrupting method and there is an additional data set of known splice creating variants. As expected, this set is concentrated well above 1, indicating that the alternative sites score higher than the reference. This part of the program, however, only checks for five prime creations given the complexity of the three prime (branch site, poly-pyrimidine tract, etc.). Since it cannot be determined for sure where a variant would be relative to the cryptic splice site it creates, every possible octamer containing the variant is scored. A sliding window of eight, starting 7 nucleotides upstream of the variant, scores each octamer. This is done with the reference allele and the alternative allele. The highest information score from each set of sliding window scores is used to compute the ratio. The final score is simply the proportion of exonic SNP that score less than the ratio we are scoring. 
